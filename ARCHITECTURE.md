# Arquitectura del Sistema - DeepChat Secure

## ğŸ“± Vista General de la AplicaciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEEPCHAT SECURE                          â”‚
â”‚                   AplicaciÃ³n Android                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              CAPA DE PRESENTACIÃ“N                     â”‚  â”‚
â”‚  â”‚  (Kivy UI Framework - main.py)                        â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚  Login     â”‚ â”‚   Main     â”‚ â”‚    Chat    â”‚        â”‚  â”‚
â”‚  â”‚  â”‚  Screen    â”‚ â”‚   Screen   â”‚ â”‚   Screen   â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚  â”‚  Video     â”‚ â”‚  Settings  â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚  Screen    â”‚ â”‚   Screen   â”‚                       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            CAPA DE LÃ“GICA DE NEGOCIO                  â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚  â”‚   Crypto     â”‚  â”‚     Tor      â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚   Manager    â”‚  â”‚   Manager    â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ RSA-4096   â”‚  â”‚ â€¢ Hidden Svc â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Fernet     â”‚  â”‚ â€¢ SOCKS5     â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Signatures â”‚  â”‚ â€¢ .onion     â”‚                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â”‚
â”‚  â”‚  â”‚     P2P      â”‚  â”‚    Video     â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚   Network    â”‚  â”‚   Stream     â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Messaging  â”‚  â”‚ â€¢ OpenCV     â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Protocol   â”‚  â”‚ â€¢ JPEG       â”‚                  â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Sockets    â”‚  â”‚ â€¢ Streaming  â”‚                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              CAPA DE TRANSPORTE                       â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚         Red TOR (Onion Routing)                       â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚    Guardia  â†’  Nodo Medio  â†’  Nodo Salida            â”‚  â”‚
â”‚  â”‚      ğŸ”           ğŸ”              ğŸ”                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           ALMACENAMIENTO LOCAL                        â”‚  â”‚
â”‚  â”‚                                                        â”‚  â”‚
â”‚  â”‚  ~/.deepchat/                                         â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ private_key.pem (ğŸ”’ Encriptado)                 â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ public_key.pem                                   â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ identity.json                                    â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ contacts.json                                    â”‚  â”‚
â”‚  â”‚  â””â”€â”€ messages/                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Flujo de Mensaje Encriptado

```
ALICE                                              BOB
  â”‚                                                  â”‚
  â”‚  1. Escribir mensaje                            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
  â”‚                              â”‚                  â”‚
  â”‚  2. Generar clave Fernet     â”‚                  â”‚
  â”‚     (AES-256 simÃ©trica)      â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                              â”‚                  â”‚
  â”‚  3. Encriptar mensaje        â”‚                  â”‚
  â”‚     con Fernet               â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                              â”‚                  â”‚
  â”‚  4. Encriptar clave Fernet   â”‚                  â”‚
  â”‚     con RSA pÃºblico de Bob   â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
  â”‚                              â”‚                  â”‚
  â”‚  5. Firmar con RSA privado   â”‚                  â”‚
  â”‚     de Alice                 â”‚                  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
  â”‚                                                  â”‚
  â”‚  6. Enviar por Tor (3 saltos)                   â”‚
  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•>   â”‚
  â”‚    ğŸ” Guardia â†’ ğŸ” Medio â†’ ğŸ” Salida           â”‚
  â”‚                                                  â”‚
  â”‚                                 7. Recibir paquete
  â”‚                                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                 â”‚                    â”‚
  â”‚                                 â”‚ 8. Verificar firma â”‚
  â”‚                                 â”‚    con RSA pÃºblico â”‚
  â”‚                                 â”‚    de Alice        â”‚
  â”‚                                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                 â”‚                    â”‚
  â”‚                                 â”‚ 9. Desencriptar    â”‚
  â”‚                                 â”‚    clave Fernet    â”‚
  â”‚                                 â”‚    con RSA privado â”‚
  â”‚                                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                 â”‚                    â”‚
  â”‚                                 â”‚ 10. Desencriptar   â”‚
  â”‚                                 â”‚     mensaje con    â”‚
  â”‚                                 â”‚     Fernet         â”‚
  â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                  â”‚
  â”‚                              11. Mostrar mensaje â”‚
  â”‚                                                  â”‚
```

## ğŸ¥ Flujo de Videollamada

```
ALICE                                              BOB
  â”‚                                                  â”‚
  â”‚  1. Presionar botÃ³n de video                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
  â”‚                     â”‚                           â”‚
  â”‚  2. Solicitud       â”‚                           â”‚
  â”‚     de llamada      â”‚                           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>             â”‚
  â”‚   {type: call_request}                          â”‚
  â”‚                                                  â”‚
  â”‚                                 3. Popup         â”‚
  â”‚                                    "Llamada      â”‚
  â”‚                                     entrante"    â”‚
  â”‚                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                                 â”‚ 4. Aceptar     â”‚
  â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚                                                  â”‚
  â”‚              <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                  {type: call_accept}            â”‚
  â”‚                                                  â”‚
  â”‚  5. Iniciar VideoStream           6. Iniciar VideoStream
  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚     â”‚ CÃ¡mara   â”‚                     â”‚ CÃ¡mara   â”‚
  â”‚     â”‚   â†“      â”‚                     â”‚   â†“      â”‚
  â”‚     â”‚ Captura  â”‚                     â”‚ Captura  â”‚
  â”‚     â”‚   â†“      â”‚                     â”‚   â†“      â”‚
  â”‚     â”‚ JPEG     â”‚                     â”‚ JPEG     â”‚
  â”‚     â”‚   â†“      â”‚                     â”‚   â†“      â”‚
  â”‚     â”‚ Compress â”‚                     â”‚ Compress â”‚
  â”‚     â”‚   â†“      â”‚                     â”‚   â†“      â”‚
  â”‚     â”‚ Base64   â”‚                     â”‚ Base64   â”‚
  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚          â”‚                                 â”‚
  â”‚          â†“                                 â†“
  â”‚  7. Enviar frame           8. Enviar frame
  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•>   <â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â”‚     15 FPS por Tor              15 FPS por Tor
  â”‚                                                  â”‚
  â”‚  9. Decodificar y mostrar  10. Decodificar y mostrar
  â”‚                                                  â”‚
```

## ğŸ—„ï¸ Estructura de Datos

### Identidad del Usuario

```json
{
  "username": "alice",
  "onion_address": "abc123...xyz.onion",
  "public_key": "MIICIjANBgkqhki...",
  "created_at": "2025-01-01T12:00:00"
}
```

### Contacto

```json
{
  "name": "Bob",
  "onion_address": "def456...uvw.onion",
  "public_key": "MIICIjANBgkqhki...",
  "fingerprint": "AA:BB:CC:DD:EE:FF:...",
  "verified": true,
  "added_at": "2025-01-01T13:00:00"
}
```

### Mensaje Encriptado (en trÃ¡nsito)

```json
{
  "type": "message",
  "from": "abc123...xyz.onion",
  "to": "def456...uvw.onion",
  "timestamp": "2025-01-01T14:30:00",
  "data": {
    "encrypted_key": "base64(RSA(Fernet_Key))",
    "encrypted_message": "base64(Fernet(mensaje))",
    "signature": "base64(RSA_Sign(mensaje))"
  }
}
```

### Mensaje Almacenado (local)

```json
{
  "id": "1704117000_1234",
  "text": "Hola, cÃ³mo estÃ¡s?",
  "timestamp": "14:30",
  "is_outgoing": true,
  "read": true
}
```

## ğŸ” Capas de Seguridad

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 5: Almacenamiento                           â”‚
â”‚  â€¢ Claves privadas encriptadas con contraseÃ±a     â”‚
â”‚  â€¢ Mensajes almacenados localmente                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 4: AutenticaciÃ³n                            â”‚
â”‚  â€¢ Firmas digitales RSA                           â”‚
â”‚  â€¢ VerificaciÃ³n de fingerprints                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 3: EncriptaciÃ³n End-to-End                  â”‚
â”‚  â€¢ RSA-4096 para intercambio de claves            â”‚
â”‚  â€¢ Fernet (AES-256) para contenido                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 2: Anonimato de Transporte                  â”‚
â”‚  â€¢ Tor Hidden Services (.onion)                   â”‚
â”‚  â€¢ Enrutamiento cebolla (3 saltos)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 1: Red FÃ­sica                               â”‚
â”‚  â€¢ Internet estÃ¡ndar                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Proceso de CompilaciÃ³n para Android

```
CÃ³digo Python
     â”‚
     â”œâ”€> buildozer init
     â”‚
     â”œâ”€> buildozer.spec
     â”‚   (configuraciÃ³n)
     â”‚
     â”œâ”€> buildozer android debug
     â”‚        â”‚
     â”‚        â”œâ”€> Descargar Android SDK/NDK
     â”‚        â”‚
     â”‚        â”œâ”€> Compilar dependencias
     â”‚        â”‚   â€¢ Kivy
     â”‚        â”‚   â€¢ Cryptography
     â”‚        â”‚   â€¢ OpenCV
     â”‚        â”‚   â€¢ PySocks
     â”‚        â”‚
     â”‚        â”œâ”€> Python-for-Android
     â”‚        â”‚   â€¢ Empaquetar cÃ³digo Python
     â”‚        â”‚   â€¢ Crear APK
     â”‚        â”‚
     â”‚        â””â”€> Firmar APK
     â”‚
     â””â”€> deepchatsecure-1.0.0-debug.apk
         (Listo para instalar)
```

## ğŸ“Š MÃ©tricas de Rendimiento

### Latencia TÃ­pica

```
Mensaje de texto:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ EncriptaciÃ³n:       10-20ms     â”‚
  â”‚ Tor routing:        2-5s        â”‚
  â”‚ DesencriptaciÃ³n:    10-20ms     â”‚
  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
  â”‚ Total:             ~2-5 segundosâ”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Videollamada:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Captura frame:      66ms (15fps)â”‚
  â”‚ CompresiÃ³n JPEG:    10-30ms     â”‚
  â”‚ EncriptaciÃ³n:       5-10ms      â”‚
  â”‚ Tor routing:        100-300ms   â”‚
  â”‚ DescompresiÃ³n:      10-30ms     â”‚
  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
  â”‚ Total por frame:   ~200-500ms   â”‚
  â”‚ Latencia percibida: ~0.5-1s     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Uso de Ancho de Banda

```
Chat:
  â€¢ Mensaje de texto (100 chars): ~2 KB
  â€¢ Mensaje con imagen (1 MB):    ~1.3 MB
  â€¢ Overhead por Tor:             ~10-20%

Video:
  â€¢ Frame 640x480 @ Quality 50:   ~15-25 KB
  â€¢ 15 FPS:                        ~225-375 KB/s
  â€¢ Con overhead Tor:              ~250-450 KB/s
  â€¢ Por minuto:                    ~15-27 MB
```

## ğŸ”§ MÃ³dulos y Responsabilidades

```
main.py
â”œâ”€â”€ LoginScreen
â”‚   â””â”€â”€ Generar/importar identidad
â”œâ”€â”€ MainScreen
â”‚   â””â”€â”€ Gestionar contactos
â”œâ”€â”€ ChatScreen
â”‚   â””â”€â”€ Enviar/recibir mensajes
â””â”€â”€ VideoCallScreen
    â””â”€â”€ Manejar videollamadas

crypto_manager.py
â”œâ”€â”€ generate_keypair()
â”œâ”€â”€ encrypt_message()
â”œâ”€â”€ decrypt_message()
â”œâ”€â”€ sign_message()
â””â”€â”€ verify_signature()

tor_manager.py
â”œâ”€â”€ start_tor()
â”œâ”€â”€ start_hidden_service()
â”œâ”€â”€ create_tor_socket()
â””â”€â”€ connect_to_onion()

p2p_network.py
â”œâ”€â”€ send_message()
â”œâ”€â”€ _listener_loop()
â”œâ”€â”€ _sender_loop()
â””â”€â”€ _process_incoming_message()

video_stream.py
â”œâ”€â”€ VideoStream
â”‚   â”œâ”€â”€ _capture_loop()
â”‚   â”œâ”€â”€ _encode_loop()
â”‚   â””â”€â”€ get_encoded_frame()
â””â”€â”€ VideoCallManager
    â”œâ”€â”€ start_call()
    â”œâ”€â”€ accept_call()
    â””â”€â”€ end_call()

utils.py
â”œâ”€â”€ Utils
â”‚   â”œâ”€â”€ generate_qr_code()
â”‚   â”œâ”€â”€ validate_onion_address()
â”‚   â””â”€â”€ format_timestamp()
â”œâ”€â”€ ContactVerifier
â”‚   â””â”€â”€ create_verification_code()
â””â”€â”€ NetworkMonitor
    â””â”€â”€ get_stats()
```

## ğŸŒ TopologÃ­a de Red

```
     ALICE                           BOB
       â”‚                              â”‚
       â”œâ”€ [Hidden Service]            â”œâ”€ [Hidden Service]
       â”‚   abc...xyz.onion            â”‚   def...uvw.onion
       â”‚         â”‚                    â”‚         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Tor Client    â”‚  â”‚   Tor Client    â”‚
        â”‚  (SOCKS Proxy)  â”‚  â”‚  (SOCKS Proxy)  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          Red Tor                     â”‚
         â”‚                                      â”‚
         â”‚   [Guardia A] â”€â†’ [Medio A] â”€â†’ [Exit A]
         â”‚        â†“              â†“           â†“   â”‚
         â”‚   [Guardia B] â”€â†’ [Medio B] â”€â†’ [Exit B]
         â”‚                                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                    Internet
```

---

**VersiÃ³n del documento:** 1.0  
**Ãšltima actualizaciÃ³n:** Enero 2025  
**Mantenedor:** Equipo DeepChat
